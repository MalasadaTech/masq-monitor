<html>
    <site-docs-content-panel-container _nghost-serverapp-c2770468599="" ng-version="18.2.1"><div _ngcontent-serverapp-c2770468599="" id="main-content" tabindex="0" appmainelement="" class="main-content"><d360-article-header _nghost-serverapp-c1159345991="" ng-version="18.2.1"><!----><!----><d360-smart-bar-initializer _ngcontent-serverapp-c1159345991="" _nghost-serverapp-c3065344057=""><!----></d360-smart-bar-initializer><!----><div _ngcontent-serverapp-c1159345991="" class="d-flex justify-content-between align-items-center mb-3"><h1 _ngcontent-serverapp-c1159345991="" class="article-title"><!----> Read API functionality examples <d360-copy-article-link _ngcontent-serverapp-c1159345991="" _nghost-serverapp-c821114996=""><button _ngcontent-serverapp-c821114996="" aria-label="Copy article link" class="btn btn-secondary btn-icon copy-article"><i _ngcontent-serverapp-c821114996="" class="fa-regular fa-link-horizontal"></i></button><!----><!----></d360-copy-article-link><!----></h1><!----></div><!----><div _ngcontent-serverapp-c1159345991="" class="article-info"><div _ngcontent-serverapp-c1159345991="" class="article-info-top"><div _ngcontent-serverapp-c1159345991="" class="d-flex article-left-actions"><!----><ul _ngcontent-serverapp-c1159345991=""><li _ngcontent-serverapp-c1159345991=""> Updated on  Oct 6, 2023 <!----></li><!----><li _ngcontent-serverapp-c1159345991=""> Published on Oct 4, 2023 <!----></li><!----><!----></ul><!----><!----></div><div _ngcontent-serverapp-c1159345991="" class="article-right-actions"><ul _ngcontent-serverapp-c1159345991=""><li _ngcontent-serverapp-c1159345991=""><i _ngcontent-serverapp-c1159345991="" class="fa-regular fa-clock me-2"></i> 3 minute(s) read </li><!----><!----></ul></div><!----></div><!----><!----><div _ngcontent-serverapp-c1159345991="" class="article-info-bottom"><div _ngcontent-serverapp-c1159345991="" class="article-contributors"><!----></div><div _ngcontent-serverapp-c1159345991="" class="article-more-options"><!----><d360-follow-unfollow _ngcontent-serverapp-c1159345991="" _nghost-serverapp-c2492756900=""><span _ngcontent-serverapp-c2492756900="" container="body" placement="top"><button _ngcontent-serverapp-c2492756900="" tabindex="0" class="btn btn-secondary follow-button"><!----><i _ngcontent-serverapp-c2492756900="" class="fa-regular fa-bell-plus me-1"></i> Follow <!----><!----></button></span><!----><!----><!----><!----></d360-follow-unfollow><!----><button _ngcontent-serverapp-c1159345991="" aria-label="toc-list-tree" class="btn btn-secondary btn-icon"><i _ngcontent-serverapp-c1159345991="" class="fa-regular fa-list-tree"></i></button><!----><d360-social-sharing _ngcontent-serverapp-c1159345991="" _nghost-serverapp-c4236359256=""><div _ngcontent-serverapp-c4236359256="" ngbdropdown="" container="body" class="d-inline-block dropdown"><button _ngcontent-serverapp-c4236359256="" type="button" id="article-social-sharing-options" aria-label="Article social sharing" ngbdropdowntoggle="" class="dropdown-toggle btn btn-icon btn-secondary toggle-icon-none" aria-expanded="false"><i _ngcontent-serverapp-c4236359256="" aria-hidden="true" class="fa-regular fa-share-nodes"></i></button><!----><div _ngcontent-serverapp-c4236359256="" ngbdropdownmenu="" aria-labelledby="article-social-sharing-options" class="dropdown-menu share-dropdown"><button _ngcontent-serverapp-c4236359256="" ngbdropdownitem="" aria-label="Twitter" class="dropdown-item" tabindex="0"><i _ngcontent-serverapp-c4236359256="" aria-hidden="true" class="fa-brands fa-x-twitter"></i></button><!----><button _ngcontent-serverapp-c4236359256="" ngbdropdownitem="" aria-label="Linkedin" class="dropdown-item" tabindex="0"><i _ngcontent-serverapp-c4236359256="" aria-hidden="true" class="fa-brands fa-linkedin"></i></button><!----><button _ngcontent-serverapp-c4236359256="" ngbdropdownitem="" aria-label="Facebook" class="dropdown-item" tabindex="0"><i _ngcontent-serverapp-c4236359256="" aria-hidden="true" class="fa-brands fa-facebook"></i></button><!----><button _ngcontent-serverapp-c4236359256="" ngbdropdownitem="" aria-label="Email" class="dropdown-item" tabindex="0"><i _ngcontent-serverapp-c4236359256="" aria-hidden="true" class="fa-solid fa-envelope"></i></button><!----></div></div><!----></d360-social-sharing><!----><d360-article-more-options _ngcontent-serverapp-c1159345991="" _nghost-serverapp-c693767385=""><div _ngcontent-serverapp-c693767385="" ngbdropdown="" autoclose="outside" container="body" class="d-inline-block dropdown"><button _ngcontent-serverapp-c693767385="" type="button" aria-label="Article more options" id="article-more-options" ngbdropdowntoggle="" class="dropdown-toggle btn btn-icon btn-secondary toggle-icon-none" aria-expanded="false"><i _ngcontent-serverapp-c693767385="" class="fa-solid fa-ellipsis"></i></button><div _ngcontent-serverapp-c693767385="" ngbdropdownmenu="" aria-labelledby="article-more-options" class="dropdown-menu"><!----><!----><button _ngcontent-serverapp-c693767385="" ngbdropdownitem="" class="dropdown-item" tabindex="0"><i _ngcontent-serverapp-c693767385="" class="fa-regular fa-print"></i> Print </button><!----></div></div><!----><!----><!----><!----><!----></d360-article-more-options><!----><!----><!----><!----></div></div><!----></div><!----><!----><!----><!----><!----><!----><!----><!----></d360-article-header><!----><!----><d360-article-content _nghost-serverapp-c2589443393="" ng-version="18.2.1"><!----><!----><!----><!----><article _ngcontent-serverapp-c2589443393="" id="articleContent" appglossaryrenderer="" appimageviewer="" apphighlight="" appeditor360tabs="" appeditor360tableshadow="" appfloikpreview="" class="md-article"><p>SPQL is implemented in the ‘Xperimental Scandata Search’ raw API.</p>
<p>The API is available via the following URL:</p>
<p><code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw</code></p>
<p>SPQL is not currently supported within the Silent Push UI, in the Query Builder section. It is only possible to use SPQL in a POST request using tools such as curl or Postman.</p>
<h2 id="calling-the-api" class="hyperlink-wrapper-container">Calling the API<button class="copy-link-btn btn btn-secondary btn-icon" data-heading-id="calling-the-api" aria-label="Copy link to Calling the API"><i class="fa-regular fa-link-horizontal"></i></button></h2>
<p>To call the API, send a POST request with a body containing a JSON object with the following structure:</p>
<p><code data-backticks="1">{“query”: “&lt;query&gt;”, “fields”:[“&lt;field1&gt;”,”&lt;field2&gt;”,…,”&lt;fieldn&gt;”], “sort”:	 [“&lt;field1&gt;/&lt;order&gt;”,”&lt;field2&gt;/&lt;order&gt;”,…,”&lt;fieldn&gt;/&lt;order&gt;”]}</code></p>
<section class="infoBox">
          <div class="title">Important!
</div>
          <div class="content"><p>The query key must contain the SPQL query as a single string in JSON encoding (i.e., double quotes must be escaped).</p>
</div></section>
<h3>Additional API rules</h3>
<p><code data-backticks="1">limit=&lt;n&gt;</code>, <code data-backticks="1">skip=&lt;n&gt;</code>, and <code data-backticks="1">with_metadata=1</code> must be given as URL parameters:</p>
<section class="infoBox">
          <div class="title">Example
</div>
          <div class="content"><p><code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw?limit=100&amp;skip=0&amp;with_metadata=1</code></p>
</div></section>
<p><code data-backticks="1">with_metadata=1</code> returns an additional metadata key (together with the results), containing information about the matching results, including a <code data-backticks="1">job_id</code> which can be used to recall the results from the search for up to 30 days.</p>
<p>To recall search results using the <code data-backticks="1">job_id</code>, use the <code data-backticks="1">job_id</code> API:</p>
<section class="infoBox">
          <div class="title">Example
</div>
          <div class="content"><p><code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/job/0005283b-8094-426a-b653-61bfa9c02d6f</code></p>
</div></section>
<h2 id="fields-key" class="hyperlink-wrapper-container">Fields key<button class="copy-link-btn btn btn-secondary btn-icon" data-heading-id="fields-key" aria-label="Copy link to Fields key"><i class="fa-regular fa-link-horizontal"></i></button></h2>
<p>The fields key is optional.</p>
<p>If given, it must include a list containing one or more fields from the list of supported field names.</p>
<p>The results from the query will be returned containing only the field names specified in the fields key. This is particularly useful for integration and automation purposes, where only specific data elements are of interest.</p>
<p>If no fields key is included, all available fields for each record in the result will be returned.</p>
<h2 id="sort-key" class="hyperlink-wrapper-container">Sort key<button class="copy-link-btn btn btn-secondary btn-icon" data-heading-id="sort-key" aria-label="Copy link to Sort key"><i class="fa-regular fa-link-horizontal"></i></button></h2>
<p>The sort key is optional.</p>
<p>If given, sort keys must include a list containing one or more fields from the below list of supported field names, followed by forward slash (<code data-backticks="1">/</code>), and the sort order (<code data-backticks="1">asc</code> or <code data-backticks="1">desc</code>).</p>
<p>If only a field name is given, without a sort order, the default sort order is <code data-backticks="1">asc</code>.</p>
<p>If a field name given in the sort key is not included in the field name given in the fields key, the field name will not be used in the sort order of the returned results.</p>
<p>If more than one field name is given, <strong>nested sorting</strong> will be applied to the results, with the first criteria in the sort key being the primary sort criteria, followed by the second criteria in the sort key, and so on.</p>
<p>If sort is not given, the default sort order will be applied: <code data-backticks="1">[“scan_date/desc”,”domain/asc”]</code></p>
<h2 id="api-call-examples" class="hyperlink-wrapper-container">API call examples<button class="copy-link-btn btn btn-secondary btn-icon" data-heading-id="api-call-examples" aria-label="Copy link to API call examples"><i class="fa-regular fa-link-horizontal"></i></button></h2>
<h3>Example 1</h3>
<p>Query returning all fields with JSON encoded/escaped query condition.</p>
<p>URL: <code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw?limit=100</code></p>
<section class="infoBox">
          <div class="title">Curl
</div>
          <div class="content"><p><code data-backticks="1">curl -ks -X POST -H ‘content-type:application/json’ -H ‘x-api-	key:&lt;api_key&gt;’</code></p>
</div></section>
<section class="warningBox">
          <div class="title">JSON
</div>
          <div class="content"><p><code data-backticks="1">-d ‘{"query": "htmltitle = \"DDoS* not configured\" AND response &gt; 200 AND header.server = ddos*"}’</code></p>
</div></section>
<h3>Example 2</h3>
<p>Description: Query returning only specified fields.</p>
<p>URL: <code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw?limit=100</code></p>
<section class="infoBox">
          <div class="title">Curl
</div>
          <div class="content"><p><code data-backticks="1">curl -ks -X POST -H ‘content-type:application/json’ -H ‘x-api-key: &lt;api_key&gt;’</code></p>
</div></section>
<section class="warningBox">
          <div class="title">JSON
</div>
          <div class="content"><p><code data-backticks="1">-d ‘{"query": "htmltitle = \"DDoS* not configured\" AND response = 200 AND header.server = ddos*", "fields": ["domain", "scan_date", "hostname", "port", "origin_port", "ip", "origin_ip", "datahash", "header.server", "header.content-type", "htmltitle", "response", "html_body_ssdeep", "ssl.sans", "tld", "ssl.not_before", "ssl.not_after", "ssl.SHA1", "url"]}’</code></p>
</div></section>
<h3>Example 3</h3>
<p>Description: RE2 encoded as json (double-backslash as a literal identifier).</p>
<p>URL: <code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw?limit=100</code></p>
<section class="infoBox">
          <div class="title">Curl
</div>
          <div class="content"><p><code data-backticks="1">curl -ks -X POST -H ‘content-type:application/json’ -H ‘x-api-key: &lt;api_key&gt;’</code></p>
</div></section>
<section class="warningBox">
          <div class="title">JSON
</div>
          <div class="content"><p><code data-backticks="1">-d {"query": "scan_date &gt; now-30d and ssl.sans ~= /^silent[a-z].+\\.io$/ and domain !~= /silent.*/ and domain ~= /.+/ and ip = [13.249.0.0/16, 52.84.0.0/16]"}</code></p>
</div></section>
<h3>Example 4</h3>
<p>Description: Explicit, nested sort order (first by domain in ascending order, then by  hostname in ascending order, and finally by scan_date in descending order).</p>
<p>URL: <code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw?limit=100</code></p>
<section class="infoBox">
          <div class="title">Curl
</div>
          <div class="content"><p><code data-backticks="1">curl -ks -X POST -H ‘content-type:application/json’ -H ‘x-api-key: &lt;api_key&gt;’</code></p>
</div></section>
<section class="warningBox">
          <div class="title">JSON
</div>
          <div class="content"><p><code data-backticks="1">-d ‘{"query": "domain = mandiant.* AND domain != mandiant.com AND scan_date &gt; now-30d", “sort”: [“domain/asc”,”hostname/asc”,”scan_date/desc”]}’</code></p>
</div></section>
<h3>Example 5</h3>
<p>Search for domain name not in .com TLD, scanned less than 30 days ago.</p>
<p>URL: <code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw?limit=100</code></p>
<section class="infoBox">
          <div class="title">Curl
</div>
          <div class="content"><p><code data-backticks="1">curl -ks -X POST -H ‘content-type:application/json’ -H ‘x-api-key: &lt;api_key&gt;’</code></p>
</div></section>
<section class="warningBox">
          <div class="title">JSON
</div>
          <div class="content"><p><code data-backticks="1">-d ‘{"query": "domain = mandiant.* AND domain != mandiant.com AND scan_date &gt; now-30d"}’</code></p>
</div></section>
<h3>Example 6</h3>
<p>Search for content-type string on servers that are not <code data-backticks="1">Apache</code> or <code data-backticks="1">nginx</code>, in either network <code data-backticks="1">83.143.113.0/16</code> or <code data-backticks="1">92.205.3.0/16</code> with an <code data-backticks="1">opendirectory</code> and <code data-backticks="1">cpanel</code> in the SSL certificate names scanned less than 10 days ago.</p>
<p>URL: <code data-backticks="1">https://api.silentpush.com/api/v1/merge-api/explore/scandata/search/raw?limit=100</code></p>
<section class="infoBox">
          <div class="title">Curl
</div>
          <div class="content"><p><code data-backticks="1">curl -ks -X POST -H ‘content-type:application/json’ -H ‘x-api-key: &lt;api_key&gt;’</code></p>
</div></section>
<section class="warningBox">
          <div class="title">JSON
</div>
          <div class="content"><p><code data-backticks="1">-d ‘{"query": "header.content-type = \"text/html; charset=iso-8859-1\" AND header.server != Apache AND header.server != nginx AND ip = [83.143.113.0/16, 92.205.3.0/16] AND opendirectory = true AND ssl.sans = cpanel* and scan_date &gt; now-10d"}’</code></p>
</div></section>
</article><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></d360-article-content><!----><!----><!----><d360-article-feedback _nghost-serverapp-c1216099204="" ng-version="18.2.1"><div _ngcontent-serverapp-c1216099204="" class="feedback-container"><p _ngcontent-serverapp-c1216099204="" class="text-center m-0 p-0"></p><div _ngcontent-serverapp-c1216099204="" class="article-feedback"><div _ngcontent-serverapp-c1216099204="" class="article-feedback-text"> Was this article helpful? </div><div _ngcontent-serverapp-c1216099204="" class="article-feedback-action"><button _ngcontent-serverapp-c1216099204="" aria-label="Yes" triggers="manual" class="btn btn-outline-secondary"><i _ngcontent-serverapp-c1216099204="" aria-hidden="true" class="fa-duotone fa-thumbs-up"></i> Yes </button><!----><button _ngcontent-serverapp-c1216099204="" aria-label="No" triggers="manual" class="btn btn-outline-secondary"><i _ngcontent-serverapp-c1216099204="" aria-hidden="true" class="fa-duotone fa-thumbs-down"></i> No </button><!----></div></div><!----></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></d360-article-feedback><!----><!----><d360-article-navigator _nghost-serverapp-c1257085134="" ng-version="18.2.1"><div _ngcontent-serverapp-c1257085134=""><div _ngcontent-serverapp-c1257085134="" class="article-navigation mb-3 justify-content-start"><button _ngcontent-serverapp-c1257085134="" tabindex="0" role="button" aria-label="Previous article" class="article-previous cursor-pointer"><div _ngcontent-serverapp-c1257085134="" class="me-2"><i _ngcontent-serverapp-c1257085134="" class="fa-regular fa-arrow-left"></i></div><div _ngcontent-serverapp-c1257085134="" class="article-navigation-content"><div _ngcontent-serverapp-c1257085134="" class="article-navigation-des"> Previous article </div><div _ngcontent-serverapp-c1257085134="" class="fw-bold text-truncate text-nowrap title pt-1">Read query examples</div></div></button><!----><button _ngcontent-serverapp-c1257085134="" tabindex="0" role="button" aria-label="Next article" class="article-next cursor-pointer"><div _ngcontent-serverapp-c1257085134="" class="article-navigation-content"><div _ngcontent-serverapp-c1257085134="" class="article-navigation-des"> Next article </div><div _ngcontent-serverapp-c1257085134="" class="fw-bold text-truncate text-nowrap title pt-1">Understand field names</div></div><div _ngcontent-serverapp-c1257085134="" class="ms-2"><i _ngcontent-serverapp-c1257085134="" class="fa-regular fa-arrow-right"></i></div></button><!----></div><!----></div><!----></d360-article-navigator><!----><!----><!----><d360-smart-bar-initializer _ngcontent-serverapp-c2770468599="" _nghost-serverapp-c3065344057=""><!----></d360-smart-bar-initializer><!----><d360-inline-integrations _ngcontent-serverapp-c2770468599="" _nghost-serverapp-c2382674119=""></d360-inline-integrations><!----><!----></div><!----><site-docs-right-panel-container _nghost-serverapp-c2784725103="" style="min-width: 250px; display: none; position: absolute;" class="" ng-version="18.2.1"><!----><!----><!----><script _ngcontent-serverapp-c2784725103="" src="https://cdnjs.cloudflare.com/ajax/libs/jsonlint/1.6.0/jsonlint.js"></script><script _ngcontent-serverapp-c2784725103="" src="https://cdn.jsdelivr.net/npm/js-yaml@4/dist/js-yaml.min.js"></script><script _ngcontent-serverapp-c2784725103="" src="https://cdnjs.cloudflare.com/ajax/libs/jsonlint/1.6.0/jsonlint.js"></script><script _ngcontent-serverapp-c2784725103="" src="https://cdn.jsdelivr.net/npm/js-yaml@4/dist/js-yaml.min.js"></script></site-docs-right-panel-container><!----><!----></site-docs-content-panel-container>
</html>